model Plan {
  id          String   @id @default(cuid())
  name        String
  description String?
  pricePaise  Int      // monthly price in paise
  currency    String   @default("INR")
  interval    String   @default("month") // month|year
  isActive    Boolean  @default(true)
  features    String[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  subscriptions Subscription[]
}

model Subscription {
  id           String   @id @default(cuid())
  user         User     @relation(fields: [userId], references: [id])
  userId       String   @unique
  plan         Plan     @relation(fields: [planId], references: [id])
  planId       String
  status       SubStatus @default(ACTIVE)
  currentPeriodStart DateTime
  currentPeriodEnd   DateTime
  cancelAtPeriodEnd  Boolean @default(false)
  provider     String   // 'stripe' | 'razorpay'
  providerSubId String? @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  invoices     Invoice[]
}

enum SubStatus { ACTIVE PAST_DUE CANCELED }

model Invoice {
  id            String   @id @default(cuid())
  subscription  Subscription @relation(fields: [subscriptionId], references: [id])
  subscriptionId String
  amountPaise   Int
  currency      String @default("INR")
  status        InvoiceStatus @default(PENDING)
  provider      String
  providerInvoiceId String?
  createdAt     DateTime @default(now())
}

enum InvoiceStatus { PENDING PAID FAILED }
